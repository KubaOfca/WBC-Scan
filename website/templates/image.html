<a data-toggle="modal" data-target="#create_batch_modal">
    <button class="btn btn-outline-secondary" type="button">Create new batch</button>
</a>

<form id="post-select" action="{{ url_for('project_views.project', project_id=session['project_id'], tab=3) }}"
      method="post">
    <select name="batch-select" class="selectpicker" id="batch-select">
        <option value="default">Choose batch...</option>
        {% for batch in batches %}
        {% if batch.name == session['batch_name'] %}
        <option value="{{ batch.name }}" selected>{{ batch.name }}</option>
        {% else %}
        <option value="{{ batch.name }}">{{ batch.name }}</option>
        {% endif %}
        {% endfor %}
    </select>
</form>


<script>
    const selectElement = document.getElementById("batch-select");
    selectElement.addEventListener("change", (event) => {
        event.preventDefault()
        document.getElementById('post-select').submit();
    });
</script>

<form method="POST" action="{{ url_for('project_views.delete_image') }}"
      id="delete_images">
    <div class="image-page-content" id="image-page-content" style="display: none">
        <a data-toggle="modal" data-target="#upload_images_modal">
            <button type="button" class="btn btn-primary">Upload Images</button>
        </a>

        <button type="submit" form="delete_images" class="btn btn-danger" onclick="return confirm('Are you sure?');"
                title="Delete project">Delete Images
        </button>

        <table id="data" class="table table-hover">
            <thead>
            <tr>
                <th>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="select-all" onClick="selectAllImages(this)"
                               value="">
                        <label class="form-check-label" for="select-all"></label>
                    </div>
                </th>
                <th>Id</th>
                <th>Name</th>
                <th>Image</th>
                <th>Annotated Image</th>
                <th>Date</th>
            </tr>
            </thead>
            <tbody>
            {% for image in images %}
            <tr>
                <td>
                    <div class="form-check">
                        <input type="checkbox" name="images-checkbox" class="form-check-input" value="{{ image.id }}">
                    </div>
                </td>
                <td>{{ image.id }}</td>
                <td>
                    {{ image.name }}
                </td>
                <td>
                    <a href="{{ url_for('static', filename=image.image) }}" target="_blank">
                        <img src="{{ url_for('static', filename=image.image) }}" style="width: 100px; height: 100px;"/>
                    </a>
                </td>
                <td>
                    {% if image.annotated_image is not none %}
                    <a href="{{ url_for('static', filename=image.annotated_image) }}" target="_blank">
                        <img src="{{ url_for('static', filename=image.annotated_image) }}"
                             style="width: 100px; height: 100px;"/>
                    </a>
                    {% else %}
                    <span class="badge badge-warning">Empty</span>
                    {% endif %}
                </td>
                <td>
                    {{ image.date.strftime('%d/%m/%Y %H:%M:%S') }}
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        <span class="badge badge-light">Rows: {{ images|length }}</span>
        <br/>
        <span class="badge badge-light">Total Rows: {{ session['total_rows'] }}</span>

        <button type="submit" form="delete_batch" class="btn btn-danger" onclick="return confirm('Are you sure?');"
                title="Delete batch">Delete batch
        </button>

        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-end">
                <li class="page-item">
                    <a class="page-link" href="{{ url_for('project_views.project', page=1, tab=3) }}">
                        First
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link"
                       href="{{ url_for('project_views.project', page=session['image_page'] - 1, tab=3) }}">
                        {{ session['image_page'] - 1 if session['image_page'] > 1 else "-"}}
                    </a>
                </li>
                <li class="page-item active">
                    <a class="page-link"
                       href="{{ url_for('project_views.project', page=session['image_page'], tab=3) }}">
                        {{ session['image_page'] }}
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link"
                       href="{{ url_for('project_views.project', page=session['image_page'] + 1, tab=3) }}">
                        {{ session['image_page'] + 1 if session['image_page'] < session['last_page'] else "-"}}</a>
                </li>
                <li class="page-item">
                    <a class="page-link"
                       href="{{ url_for('project_views.project', page=session['last_page'], tab=3) }}">
                        Last
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</form>

<form method="POST" action="{{ url_for('project_views.delete_batch') }}" id="delete_batch"></form>

<script>
    function selectAllImages(source) {
        checkboxes = document.getElementsByName('images-checkbox');
        for (var i = 0, n = checkboxes.length; i < n; i++) {
            checkboxes[i].checked = source.checked;
        }
    }
</script>

<!--Modals-->
{% include 'modals/upload_images_modal.html' %}

